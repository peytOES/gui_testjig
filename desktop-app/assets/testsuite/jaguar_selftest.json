{
  "name": "Jaguar fixture self-test",
  "description": "Set of tests to validate Jaguar production fixture using a golden sample",
  "version": "0.1",
  "db_name": "selftest",
  "retries": 1,
  "test_cases": [
    {
      "id": "PROGRAM_TEST_FIRMWARE",
      "preconditions": [],
      "name": "Program test firmare",
      "description": "Erase DUT and load production test firmware",
      "timeout": 20.0,
      "target": "ProgramFirmwareTestCase",
      "parameters": {
        "erase": true,
        "firmware_list": [
          {
            "file": "firmware/jaguar_test_fw.bin",
            "address": "0x8000000"
          }
        ]
      }
    },
    {
      "id": "DC_POWER",
      "name": "DC power check",
      "description": "Apply DC power, check current and system voltages.  Expect 3.5V, <20mA",
      "preconditions": [
        "DC_POWER"
      ],
      "timeout": 30.0,
      "target": "DCPowerTestCase",
      "parameters": {
        "v_min": 3.2,
        "v_max": 3.8,
        "i_min": 0.0002,
        "i_max": 0.025,
        "delay": 2,
        "samples": 10
      }
    },
    {
      "id": "BAT_POWER",
      "name": "BAT power check",
      "description": "Apply BAT power, check current and system voltages",
      "preconditions": [
        "DC_POWER"
      ],
      "timeout": 30.0,
      "target": "BatPowerTestCase",
      "parameters": {
        "v_min": 3.4,
        "v_max": 3.6,
        "i_min": 0.0002,
        "i_max": 0.04,
        "samples": 10,
        "delay": 2
      }
    },
    {
      "id": "ANALOG_TEST",
      "name": "Analog test",
      "description": "Analog input",
      "preconditions": [
        "BAT_POWER"
      ],
      "timeout": 40.0,
      "target": "AnalogTestCase",
      "parameters": {
        "vlow_min": 0.00,
        "vlow_max": 0.05,
        "vmid_min": 0.5,
        "vmid_max": 0.7,
        "vhigh_min": 1.1,
        "vhigh_max": 1.3,
        "vsys_min": 2.1,
        "vsys_max": 2.3
      }
    },
    {
      "id": "DIGITAL_TEST",
      "name": "Digital test",
      "description": "Digital input and output",
      "preconditions": [
        "ANALOG_TEST"
      ],
      "timeout": 40.0,
      "target": "DigitalTestCase",
      "parameters": {
      }
    },
    {
      "id": "BLE_TEST",
      "name": "BLE test",
      "description": "BLE module info, scan, connect, current measurement",
      "preconditions": [
        "DIGITAL_TEST"
      ],
      "timeout": 40.0,
      "target": "BLETestCase",
      "parameters": {
        "min_rssi": -55,
        "scan_duration": 10,
        "i_min": 0.002,
        "i_max": 0.012,
        "samples": 10
      }
    },
    {
      "id": "LTE_TEST",
      "name": "LTE test",
      "description": "LTE test & info",
      "preconditions": [
        "BLE_TEST"
      ],
      "timeout": 20.0,
      "target": "LTETestCase",
      "parameters": {
        "detect_time": 5,
        "i_min": 0,
        "i_max": 0.5,
        "samples": 10,
        "v_max": 4.1,
        "v_min": 3.6,
        "model": "SARA-R410M-02B",
        "fw_version": "L0.0.00.00.05.12.*",
        "application_version": "L0.0.00.00.05.12,A.02.19",
        "manufacturer_identification": "u-blox",
        "type_code": "SARA-R410M-02B-03",
        "files": null,
        "csq_power": null,
        "csq_quality": null,
        "cops": null,
        "creg": null
      }
    },
    {
      "id": "SLEEP_CURRENT",
      "name": "Sleep current test",
      "description": "Sleep current measurements - note that we are observing very noisy (and large) sleep current measurements, so conservative thresholds have been set.",
      "preconditions": [
        "LTE_TEST"
      ],
      "timeout": 20.0,
      "target": "SleepCurrentTestCase",
      "parameters": {
        "i_min": 0.000001,
        "i_max": 0.050,
        "samples": 50,
        "delay": 10
      }
    },
    {
      "id": "PROGRAM_PRODUCTION_FIRMWARE",
      "preconditions": [
        "PROGRAM_PRODUCTION_FIRMWARE"
      ],
      "name": "Program production firmare",
      "description": "Erase DUT and load production firmware",
      "timeout": 20.0,
      "target": "ProgramFirmwareTestCase",
      "parameters": {
        "erase": true,
        "firmware_list": [
          {
            "file": "firmware/bootloader.bin",
            "address": "0x8000000"
          },
          {
            "file": "firmware/jaguar_production.bin",
            "address": "0x8002000"
          }
        ]
      }
    },
    {
      "id": "SET_RDP",
      "preconditions": [
        "SLEEP_CURRENT"
      ],
      "name": "Set RDP",
      "description": "Set readout protection",
      "target": "MemoryProtectTestcase",
      "timeout": 10.0,
      "parameters": {
        "rdp_level": 1
      }
    }
  ]
}
